!function(r,a){"use strict";Foundation.libs.interchange={name:"interchange",version:"5.5.2",cache:{},images_loaded:!1,nodes_loaded:!1,settings:{load_attr:"interchange",named_queries:{"default":"only screen",small:Foundation.media_queries.small,"small-only":Foundation.media_queries["small-only"],medium:Foundation.media_queries.medium,"medium-only":Foundation.media_queries["medium-only"],large:Foundation.media_queries.large,"large-only":Foundation.media_queries["large-only"],xlarge:Foundation.media_queries.xlarge,"xlarge-only":Foundation.media_queries["xlarge-only"],xxlarge:Foundation.media_queries.xxlarge,landscape:"only screen and (orientation: landscape)",portrait:"only screen and (orientation: portrait)",retina:"only screen and (-webkit-min-device-pixel-ratio: 2),only screen and (min--moz-device-pixel-ratio: 2),only screen and (-o-min-device-pixel-ratio: 2/1),only screen and (min-device-pixel-ratio: 2),only screen and (min-resolution: 192dpi),only screen and (min-resolution: 2dppx)"},directives:{replace:function(e,i,a){if(null!==e&&/IMG/.test(e[0].nodeName)){var t=e[0].src;if(new RegExp(i,"i").test(t))return;return e.attr("src",i),a(e[0].src)}var n=e.data(this.data_attr+"-last-path"),s=this;if(n!=i)return/\.(gif|jpg|jpeg|tiff|png)([?#].*)?/i.test(i)?(r(e).css("background-image","url("+i+")"),e.data("interchange-last-path",i),a(i)):r.get(i,function(t){e.html(t),e.data(s.data_attr+"-last-path",i),a()})}}},init:function(t,e,i){Foundation.inherit(this,"throttle random_str"),this.data_attr=this.set_data_attr(),r.extend(!0,this.settings,e,i),this.bindings(e,i),this.reflow()},get_media_hash:function(){var t="";for(var e in this.settings.named_queries)t+=matchMedia(this.settings.named_queries[e]).matches.toString();return t},events:function(){var e,i=this;return r(a).off(".interchange").on("resize.fndtn.interchange",i.throttle(function(){var t=i.get_media_hash();t!==e&&i.resize(),e=t},50)),this},resize:function(){var t=this.cache;if(this.images_loaded&&this.nodes_loaded){for(var e in t)if(t.hasOwnProperty(e)){var i=this.results(e,t[e]);i&&this.settings.directives[i.scenario[1]].call(this,i.el,i.scenario[0],function(t){if(arguments[0]instanceof Array)var e=arguments[0];else e=Array.prototype.slice.call(arguments,0);return function(){t.el.trigger(t.scenario[1],e)}}(i))}}else setTimeout(r.proxy(this.resize,this),50)},results:function(t,e){var i=e.length;if(0<i)for(var a=this.S("["+this.add_namespace("data-uuid")+'="'+t+'"]');i--;){var n=e[i][2];if((this.settings.named_queries.hasOwnProperty(n)?matchMedia(this.settings.named_queries[n]):matchMedia(n)).matches)return{el:a,scenario:e[i]}}return!1},load:function(t,e){return("undefined"==typeof this["cached_"+t]||e)&&this["update_"+t](),this["cached_"+t]},update_images:function(){var t=this.S("img["+this.data_attr+"]"),e=t.length,i=e,a=0,n=this.data_attr;for(this.cache={},this.cached_images=[],this.images_loaded=0===e;i--;){if(a++,t[i])0<(t[i].getAttribute(n)||"").length&&this.cached_images.push(t[i]);a===e&&(this.images_loaded=!0,this.enhance("images"))}return this},update_nodes:function(){var t=this.S("["+this.data_attr+"]").not("img"),e=t.length,i=e,a=0,n=this.data_attr;for(this.cached_nodes=[],this.nodes_loaded=0===e;i--;){a++,0<(t[i].getAttribute(n)||"").length&&this.cached_nodes.push(t[i]),a===e&&(this.nodes_loaded=!0,this.enhance("nodes"))}return this},enhance:function(t){for(var e=this["cached_"+t].length;e--;)this.object(r(this["cached_"+t][e]));return r(a).trigger("resize.fndtn.interchange")},convert_directive:function(t){var e=this.trim(t);return 0<e.length?e:"replace"},parse_scenario:function(t){var e=t[0].match(/(.+),\s*(\w+)\s*$/),i=t[1].match(/(.*)\)/);if(e)var a=e[1],n=e[2];else a=t[0].split(/,\s*$/)[0],n="";return[this.trim(a),this.convert_directive(n),this.trim(i[1])]},object:function(t){var e=this.parse_data_attr(t),i=[],a=e.length;if(0<a)for(;a--;){var n=e[a].split(/,\s?\(/);if(1<n.length){var s=this.parse_scenario(n);i.push(s)}}return this.store(t,i)},store:function(t,e){var i=this.random_str(),a=t.data(this.add_namespace("uuid",!0));return this.cache[a]?this.cache[a]:(t.attr(this.add_namespace("data-uuid"),i),this.cache[i]=e)},trim:function(t){return"string"==typeof t?r.trim(t):t},set_data_attr:function(t){return t?0<this.namespace.length?this.namespace+"-"+this.settings.load_attr:this.settings.load_attr:0<this.namespace.length?"data-"+this.namespace+"-"+this.settings.load_attr:"data-"+this.settings.load_attr},parse_data_attr:function(t){for(var e=t.attr(this.attr_name()).split(/\[(.*?)\]/),i=e.length,a=[];i--;)4<e[i].replace(/[\W\d]+/,"").length&&a.push(e[i]);return a},reflow:function(){this.load("images",!0),this.load("nodes",!0)}}}(jQuery,window,window.document);