<!DOCTYPE html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    


  <title>Testeo unitario avanzado</title>
  <meta property="og:title" content="Testeo unitario avanzado" />






<link rel="canonical" href="wiki.uqbar.org/wiki/articles/kotest-testeo-unitario-avanzado.html" />
<meta property="og:url" content="wiki.uqbar.org/wiki/articles/kotest-testeo-unitario-avanzado.html" />
<meta property="og:site_name" content="uqbar-wiki" />
<meta name="application-name" content="uqbar-wiki"/>

<meta property="og:updated_time" content=" 2025-07-10T21:15:21-03:00" />






  <meta property="keywords" content="" />











    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
    <link type="text/plain" rel="author" href="/humans.txt"/>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nunito&display=swap" rel="stylesheet">    

    <link rel="stylesheet" href="/assets/app-1e946f931f577cd478e6e6610915be9d.css">
    <style>
        .navbar {
            -webkit-backface-visibility: hidden;
        }
    </style>
</head>

<body>

<nav class="top-bar navbar-background" data-topbar>
    <ul class="title-area">
        <li class="name">
            <div id="pagetitle"><img alt="Uqbar" src="/img/proyecto-uqbarwiki.png" height="100px"
                    width="100px" /></div>
        </li>
    </ul>
    <ul class="left">
        <div class="mobile">
            <div class="navbar-buttons">
                <div class="navbar-icon-link">
                    <a href="/"><img alt="Home" src="/img/wiki/home-2.png" height="25px"
                            width="25px" title="Home" /></a>
                </div>
                <div class="navbar-icon-link">
                    <a href="/articles"><img alt="Artículos" src="/img/wiki/list.png"
                            height="25px" width="25px" title="Artículos" /></a>
                </div>
            </div>
        </div>
    </ul>
</nav>

<div class="column small-0 medium-2 large-2 sidebar" style="margin-top: 5px;">
        <!-- Html Elements for Search -->
<div id="search-container">
    <input type="text" id="search-input" name="search-input" placeholder="Artículo a buscar...">
    <ul id="results-container"></ul>
    <hr>
</div>

        <div class="not-mobile">
                <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Links" role="menu">
                        <li class="button" role="menuitem"><a href="/" class="sidebar-link"><img
                                                alt="Home" src="/img/wiki/home-2.png" height="35px"
                                                width="35px" />&nbsp;&nbsp;&nbsp;Home</a></li>
                        <li class="button" role="menuitem"><a href="/articles" class="sidebar-link"><img
                                                alt="Artículos" src="/img/wiki/list.png" height="35px"
                                                width="35px" />&nbsp;&nbsp;&nbsp;Artículos</a></li>
                </ul>

                <hr>

                <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" role="menu">
                        <img src="/img/wiki/utn.png" alt="UTN" height="40px" width="40px" title="UTN" />
                        <li class="button" role="menuitem"><a
                                        href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas
                                        de
                                        programación</a></li>
                        <li class="button" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño de
                                        Sistemas</a>
                        </li>
                        <li class="button" role="menuitem"><a
                                        href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas
                                        avanzadas de programación</a></li>
                        <br>
                        <img src="/img/wiki/unsam.png" alt="UNSAM" height="40px" width="40px"
                                title="UNSAM" />
                        <li class="button" role="menuitem"><a href="/wiki/articles/algo2-temario.html">Algoritmos
                                        II</a></li>
                        <li class="button" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos
                                        III</a></li>
                        <li class="button" role="menuitem"><a href="/wiki/articles/phm-temario.html">Programación
                                        con
                                        Herramientas
                                        Modernas</a></li>
                </ul>
        </div>
</div>

<div class="column small-12 medium-10 large-10">
    <div id="article_title">
    <h1>
        <i>Testeo unitario avanzado</i>
    </h1>
</div>



<div id="article_content">
    <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#tocAnchor-1-1"><span class="tocnumber">1</span> <span class="toctext">Ejemplo</span></a>
            </li>
            <li class="toc_level-1 toc_section-2">
              <a href="#tocAnchor-1-2"><span class="tocnumber">2</span> <span class="toctext">Definiendo los escenarios</span></a>
            </li>
            <li class="toc_level-1 toc_section-3">
              <a href="#tocAnchor-1-3"><span class="tocnumber">3</span> <span class="toctext">Estructura de los tests</span></a>
            </li>
            <li class="toc_level-1 toc_section-4">
              <a href="#tocAnchor-1-4"><span class="tocnumber">4</span> <span class="toctext">Definiendo las especificaciones de los tests</span></a>
              <ul>
                <li class="toc_level-2 toc_section-5">
                  <a href="#tocAnchor-1-4-1"><span class="tocnumber">4.1</span> <span class="toctext">Agrupar los escenarios en diferentes archivos</span></a>
                </li>
                <li class="toc_level-2 toc_section-6">
                  <a href="#tocAnchor-1-4-2"><span class="tocnumber">4.2</span> <span class="toctext">Expresividad en los tests</span></a>
                </li>
                <li class="toc_level-2 toc_section-7">
                  <a href="#tocAnchor-1-4-3"><span class="tocnumber">4.3</span> <span class="toctext">AAA Pattern</span></a>
                </li>
                <li class="toc_level-2 toc_section-8">
                  <a href="#tocAnchor-1-4-4"><span class="tocnumber">4.4</span> <span class="toctext">TL;DR</span></a>
                </li>
                <li class="toc_level-2 toc_section-9">
                  <a href="#tocAnchor-1-4-5"><span class="tocnumber">4.5</span> <span class="toctext">Links relacionados</span></a>
                </li>
              </ul>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><p>Este artículo presenta algunas guías para desarrollar los casos de prueba, considerando que ya tienen una base de testeo unitario automatizado. Si estás buscando estudiar el tema en profundidad, te recomendamos el siguiente <a href="https://docs.google.com/document/d/1zj-H_qPbUDvWsWhV2YLaPsnrI0MIkCuoeK_ilzSnxVI/edit?usp=sharing">apunte de Testing</a>.</p>

<p>
  <br />
</p>

<p>Por otra parte, aquí explicamos la mecánica utilizando Kotest como framework de testeo, si estás buscando una variante que siga los lineamientos de JUnit, podés ver <a href="testeo-unitario-avanzado.html">esta página</a>.</p>

<h1 id="tocAnchor-1-1">Ejemplo</h1>

<p>Un sistema de seguros de automotor define en qué casos se puede pagar un siniestro:</p>

<ul>
  <li>para los clientes normales, si no son morosos (la deuda debe ser 0)</li>
  <li>para las flotas de autos, se soporta una deuda de hasta $ 10.000 si el cliente tiene más de 5 vehículos ó hasta $ 5.000 en caso contrario</li>
</ul>

<h1 id="tocAnchor-1-2">Definiendo los escenarios</h1>

<p>En base al ejemplo anterior, podemos considerar los siguientes escenarios:</p>

<ul>
  <li>un cliente normal moroso: si debe $ 1 ó $ 50.000 no nos importa, porque está en la misma <a href="http://en.wikipedia.org/wiki/Equivalence_partitioning">clase de equivalencia</a></li>
  <li>una flota con menos de 5 autos (ó 5 autos) =&gt; serían “pocos” autos</li>
  <li>una flota con más de 5 autos =&gt; serían “muchos” autos</li>
</ul>

<p>Elegimos cuántos autos en base al <strong>valor límite</strong>: como a partir de los seis autos se considera mucho y menos de 6 son “pocos” autos, 6 es el valor de una flota con muchos autos, 5 es el valor de una flota con pocos autos.</p>

<h1 id="tocAnchor-1-3">Estructura de los tests</h1>

<p>La estructura que tienen los tests en base a los escenarios propuestos podría ser:</p>

<div class="language-plaintext highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>dado un cliente normal
  ├── que es moroso: no puede cobrar un siniestro
  └── que no es moroso: puede cobrar un siniestro
dado un cliente de flota con muchos autos (6 autos)
  ├── si el cliente debe más de $ 10.000 no puede cobrar un siniestro
  └── si el cliente debe $ 10.000 o menos, puede cobrar un siniestro
dado un cliente de flota con pocos autos (5 autos)
  ├── si el cliente debe más de $ 5.000 no puede cobrar un siniestro
  └── si el cliente debe $ 5.000 o menos puede cobrar un siniestro
</code>
    </pre>
  </div>
</div>

<h1 id="tocAnchor-1-4">Definiendo las especificaciones de los tests</h1>

<p>Necesitamos</p>

<ul>
  <li>un cliente normal</li>
  <li>una flota de 6 autos</li>
  <li>otra flota de 5 autos</li>
</ul>

<p>a los que podemos configurar diferentes grados de deuda. Podemos seguir algunas recomendaciones adicionales:</p>

<h2 id="tocAnchor-1-4-1">Agrupar los escenarios en diferentes archivos</h2>

<p>Por el momento, no tenemos demasiados requerimientos. Entonces vamos a trabajar los tres escenarios desde el mismo archivo, al que llamaremos <code class="language-plaintext highlighter-rouge">CobroSiniestroSpec.kt</code> para explicitar el caso de uso que estamos testeando.</p>

<p>
  <br />
</p>

<p>A la hora de diseñar nuestros tests, hay dos ideas que están en tensión</p>

<ul>
  <li>reutilizar nuestros escenarios, es decir, los objetos que estamos testeando</li>
  <li>que en cada test quede claro qué objetos participan de esa prueba (lo que se llama SUT, System Under Test)</li>
</ul>

<!-- -->
<p>
  <br />
</p>

<p>Por ejemplo, podríamos tener una flota con 6 autos y hacer tests para diferentes casos de uso: el cobro de un siniestro, el valor mensual de la cuota, el horario de atención, etc. El tema es que los tendremos en distintos archivos de test. La reutilización nos lleva a poner las cosas en un solo lugar, por ejemplo definiendo variables de instancia en una superclase común (o cualquier mecanismo que aumenta el alcance de la variable, volviéndola más global). Todo eso dificulta el entendimiento posterior del test, porque el código que se ejecuta previo a él está en varios lugares que además no son fáciles de rastrear. Más abajo veremos qué técnicas podemos utilizar para mantener nuestros tests simples.</p>

<!-- -->
<p><br />
Cada uno de los escenarios se implementa con un <code class="language-plaintext highlighter-rouge">describe</code> diferente, entonces tendremos 3 describes:</p>

<ul>
  <li>uno para clientes normales,</li>
  <li>otro para una flota con pocos autos</li>
  <li>y otro para una flota con muchos autos</li>
</ul>

<p>Es importante que no haya demasiados detalles de implementación en la descripción de los describes: “dada una flota con 5 autos” o “data una flota con 6 autos” provoca que cualquier cambio del negocio respecto a lo que son “muchos” o “pocos” autos necesite modificar esa descripción: es una duplicidad difícil de detectar.</p>

<h3 id="intention-revealing---parte-1">Intention revealing - parte 1</h3>

<p>Queremos expresar lo más claramente posible <strong>qué clase de equivalencia está testeando el describe</strong>. Por eso comenzamos escribiendo:</p>

<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="n">describe</span><span class="o">(</span><span class="s">"Tests Cobro Siniestro"</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">describe</span><span class="o">(</span><span class="s">"Dado un cliente normal"</span><span class="o">)</span> <span class="o">{</span>
			<span class="o">...</span>

		<span class="n">describe</span><span class="o">(</span><span class="s">"Dada una flota con muchos autos"</span><span class="o">)</span> <span class="o">{</span>
			<span class="o">...</span>
</code>
    </pre>
  </div>
</div>

<p>Los describes agrupan los tests e incluso se pueden anidar, aunque por simplicidad solo vamos a utilizar un describe raíz para explicitar qué caso de uso estamos testeando. Una vez más recordamos: “muchos autos” es mejor que decir “6 autos”. En otras palabras, explicitar el caso de prueba y no el dato de prueba: 6 autos es un dato concreto, pero lo que representa es el caso de prueba de una flota con muchos autos.</p>

<h2 id="tocAnchor-1-4-2">Expresividad en los tests</h2>

<h3 id="un-primer-approach">Un primer approach</h3>

<p>Para crear nuestro fixture de una flota con muchos autos, los enunciados suelen traer ejemplos como: “Lidia Pereyra tiene una flota con 6 autos”. Es tentador escribir un test como el siguiente:</p>

<div class="language-kotlin highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="n">describe</span><span class="p">(</span><span class="s">"Lidia Pereyra"</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">val</span> <span class="py">pereyra</span> <span class="p">=</span> <span class="n">Flota</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
		<span class="n">cantidadAutos</span> <span class="p">=</span> <span class="m">6</span>
	<span class="p">}</span>
	<span class="n">it</span><span class="p">(</span><span class="s">"no puede cobrar siniestro"</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pereyra</span><span class="p">.</span><span class="n">generarDeuda</span><span class="p">(</span><span class="m">10001</span><span class="p">)</span>
		<span class="n">pereyra</span><span class="p">.</span><span class="n">puedeCobrarSiniestro</span><span class="p">()</span> <span class="n">shouldBe</span> <span class="k">false</span>
	<span class="p">}</span>
	<span class="o">..</span><span class="p">.</span>
<span class="p">}</span>
</code>
    </pre>
  </div>
</div>

<p>Pero ¿qué pasa si hay un error en el código de negocio? Supongamos esta implementación, donde la clase Cliente tiene la definición de la deuda como un entero:</p>

<div class="language-kotlin highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="kd">class</span> <span class="nc">Flota</span> <span class="p">:</span> <span class="n">Cliente</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="py">autos</span><span class="p">:</span> <span class="n">Int</span> <span class="p">=</span> <span class="m">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">puedeCobrarSiniestro</span><span class="p">()</span> <span class="p">=</span>
        <span class="k">this</span><span class="p">.</span><span class="n">deuda</span> <span class="p">&lt;=</span> <span class="n">maximoPermitido</span><span class="p">()</span>

    <span class="k">fun</span> <span class="nf">maximoPermitido</span><span class="p">()</span> <span class="p">=</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">autos</span> <span class="p">&lt;=</span> <span class="m">5</span><span class="p">)</span> <span class="m">5000</span> <span class="k">else</span> <span class="m">20000</span> <span class="c1">// debería ser 10000 en lugar de 20000
</span>
<span class="p">}</span>
</code>
    </pre>
  </div>
</div>

<p>Cuando ejecutamos el test tenemos muy poca información relevante:</p>

<p>
  <img src="/img/wiki/kotest-variable-no-representativa.png" alt="Kotest - nombre de variable no representativa" />
</p>

<ul>
  <li>la variable <code class="language-plaintext highlighter-rouge">pereyra</code> no está revelando que es un cliente de flota con muchos autos</li>
  <li>y tampoco está claro por qué no puede cobrar el siniestro el cliente.</li>
</ul>

<p>Al fallar la condición tenemos que bucear en el código y extraer este dato para determinar si el error está en el test o en el código de negocio.</p>

<h3 id="una-segunda-oportunidad">Una segunda oportunidad</h3>

<p>Vamos a mejorar la semántica del test, renombrando la variable <code class="language-plaintext highlighter-rouge">pereyra</code> por un nombre más representativo de la clase de equivalencia que estamos modelando y cambiando la descripción para el test:</p>

<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="n">describe</span><span class="o">(</span><span class="s">"Dada una flota con muchos autos"</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">val</span> <span class="n">flotaConMuchosAutos</span> <span class="o">=</span> <span class="n">Flota</span><span class="o">()</span>
	<span class="n">flotaConMuchosAutos</span><span class="o">.</span><span class="na">autos</span> <span class="o">=</span> <span class="mi">6</span>
	<span class="n">it</span><span class="o">(</span><span class="s">"si tiene mucha deuda no puede cobrar siniestro"</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">flotaConMuchosAutos</span><span class="o">.</span><span class="na">generarDeuda</span><span class="o">(</span><span class="mi">10001</span><span class="o">)</span>
		<span class="n">flotaConMuchosAutos</span><span class="o">.</span><span class="na">puedeCobrarSiniestro</span><span class="o">()</span> <span class="n">shouldBe</span> <span class="kc">false</span>
	<span class="o">}</span>
</code>
    </pre>
  </div>
</div>

<p>Ahora al fallar el test sabemos más cosas:</p>

<p>
  <img src="/img/wiki/kotest-testeo-expresivo.png" alt="mas expresividad en los tests" />
</p>

<ul>
  <li>el test con su stack trace, pero también</li>
  <li>qué es lo que estamos testeando, tratando de no entrar en detalles para no duplicar lo que dice el código</li>
</ul>

<!-- -->
<p>
  <br />
</p>

<h2 id="tocAnchor-1-4-3">AAA Pattern</h2>

<p>Los tests suelen estructurarse según el patrón AAA: Arrange, Act y Assert.</p>

<div class="language-kotlin highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="n">describe</span><span class="p">(</span><span class="s">"Dada una flota con muchos autos"</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// Arrange
</span>	<span class="kd">val</span> <span class="py">flotaConMuchosAutos</span> <span class="p">=</span> <span class="n">crearFlota</span><span class="p">(</span><span class="m">6</span><span class="p">)</span>
	<span class="n">it</span><span class="p">(</span><span class="s">"si tiene mucha deuda no puede cobrar siniestro"</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Act
</span>		<span class="n">flotaConMuchosAutos</span><span class="p">.</span><span class="n">generarDeuda</span><span class="p">(</span><span class="m">10001</span><span class="p">)</span>
		<span class="c1">// Assert
</span>		<span class="n">flotaConMuchosAutos</span><span class="p">.</span><span class="n">puedeCobrarSiniestro</span><span class="p">()</span> <span class="n">shouldBe</span> <span class="k">false</span>
	<span class="p">}</span>
	<span class="n">it</span><span class="p">(</span><span class="s">"si no tiene poca deuda puede cobrar siniestro"</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Act
</span>		<span class="n">flotaConMuchosAutos</span><span class="p">.</span><span class="n">generarDeuda</span><span class="p">(</span><span class="m">10000</span><span class="p">)</span>
		<span class="c1">// Assert
</span>		<span class="n">flotaConMuchosAutos</span><span class="p">.</span><span class="n">puedeCobrarSiniestro</span><span class="p">()</span> <span class="n">shouldBe</span> <span class="k">true</span>
	<span class="p">}</span>
<span class="p">}</span>
</code>
    </pre>
  </div>
</div>

<h3 id="arrange">Arrange</h3>

<p>En el <strong>A</strong>rrange: donde instanciamos los objetos a testear, con sus colaboradores: en el ejemplo son la flota y sus autos.</p>

<p>Instanciar un objeto adecuado para el test puede involucrar varios pasos, en ese caso es conveniente definir métodos <em>helpers</em> que además puedan reutilizarse en diferentes contextos:</p>

<div class="language-kotlin highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="k">fun</span> <span class="nf">crearFlota</span><span class="p">(</span><span class="n">cantidadAutos</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">=</span>
	<span class="n">Flota</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
		<span class="n">autos</span> <span class="p">=</span> <span class="n">cantidadAutos</span>
	<span class="p">}</span>

<span class="o">..</span><span class="p">.</span>		

<span class="n">describe</span><span class="p">(</span><span class="s">"Dada una flota con muchos autos"</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// Arrange
</span>	<span class="kd">val</span> <span class="py">flotaConMuchosAutos</span> <span class="p">=</span> <span class="n">crearFlota</span><span class="p">(</span><span class="m">6</span><span class="p">)</span>
</code>
    </pre>
  </div>
</div>

<p>En el ejemplo tenemos un método <em>helper</em> del test que permite crear un objeto Flota pasándole la cantidad de autos a crear. De esa manera la configuración de una flota ocurre en una sola línea y se puede incluir dentro del test mismo. El número 6 representa el <strong>valor límite</strong> para la flota, podríamos setearlo en base a una constante asociado a la clase Flota:</p>

<div class="language-kotlin highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="c1">// clase Flota
</span><span class="kd">val</span> <span class="py">LIMITE_MUCHOS_AUTOS</span> <span class="p">=</span> <span class="m">5</span>

<span class="c1">// el test
</span><span class="n">describe</span><span class="p">(</span><span class="s">"Dada una flota con muchos autos"</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// Arrange
</span>	<span class="kd">val</span> <span class="py">flotaConMuchosAutos</span> <span class="p">=</span> <span class="n">crearFlota</span><span class="p">(</span><span class="n">LIMITE_MUCHOS_AUTOS</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span>
</code>
    </pre>
  </div>
</div>

<p>La única cuestión a tener en cuenta aquí es que está bueno que los tests tengan <strong>la mínima lógica posible</strong>, de manera de no estar repitiendo la misma lógica que ya tiene el negocio: la ventaja que tiene escribir <code class="language-plaintext highlighter-rouge">crearFlota(6)</code> es que si el límite de lo que se considera muchos autos cambia, el test falla y eso puede ser útil.</p>

<blockquote>
  <p>Una heurística posible sobre el setup del test es tratar de mantenerlo simple y de alto nivel, más cercano al lenguaje del dominio que con detalles de implementación. En el ejemplo de arriba se logra con mensajes que se encargan de instanciar objetos de dominio y que esconden la complejidad de conocer la colaboración entre la flota y sus autos). Una alternativa a tener métodos en el test puede ser crear un objeto específico que construya otro objeto, algo que dejaremos para más adelante.</p>
</blockquote>

<p>
  <br />
</p>

<h3 id="act">Act</h3>

<p><strong>A</strong>ct: son las operaciones que tienen efecto. En el caso de la flota que tiene una deuda abultada, enviamos el mensaje que le genera la deuda. Hay tests que quizás no necesiten disparar acciones, y está bien que eso ocurra.</p>

<h3 id="assert">Assert</h3>

<p>En el <strong>A</strong>ssert indicamos qué esperamos que pase, generalmente asociado a las respuestas que da el envío de un mensaje al objeto testeado. Para esto utilizamos los <a href="https://kotest.io/docs/assertions/matchers.html">matchers</a> de Kotest.</p>

<h3 id="one-assert-per-test">“One assert per test”</h3>

<p>Hay ciertas controversias respecto a si <a href="https://softwareengineering.stackexchange.com/questions/7823/is-it-ok-to-have-multiple-asserts-in-a-single-unit-test">podemos tener varios asserts en el mismo test</a>, ya que cuando el primer assert falla los siguientes no se siguen evaluando: esto en realidad depende del <strong>runner</strong> de los tests, podríamos eventualmente trabajar con un framework que continue buscando asserts y discrimine cuáles anduvieron y cuáles no (RSpec, framework de testeo para Ruby, hace ésto).</p>

<p>En verdad, la heurística que nos interesa recomendar es: <strong>los tests deben fallar por exactamente un solo motivo</strong>, esto relaja esa restricción. Lo importante no es tener un solo assert, sino que todos los asserts estén relacionados con la misma funcionalidad. Dejamos un ejemplo concreto:</p>

<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="n">describe</span><span class="o">(</span><span class="s">"Dado un parser de patentes de autos"</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">it</span><span class="o">(</span><span class="s">"se obtiene correctamente la parte numérica de una patente vieja"</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">val</span> <span class="n">lista</span> <span class="o">=</span> <span class="n">PatenteParser</span><span class="o">(</span><span class="s">"ABC257"</span><span class="o">).</span><span class="na">parsearNumeros</span><span class="o">()</span>
		<span class="n">lista</span><span class="o">.</span><span class="na">size</span> <span class="n">shouldBe</span> <span class="mi">3</span>
		<span class="n">lista</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">shouldBe</span> <span class="mi">2</span>
		<span class="n">lista</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="n">shouldBe</span> <span class="mi">5</span>
		<span class="n">lista</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="n">shouldBe</span> <span class="mi">7</span>
	<span class="o">}</span>
<span class="o">}</span>
</code>
    </pre>
  </div>
</div>

<p>El lector puede profundizar con estos artículos:</p>

<ul>
  <li><a href="https://www.industriallogic.com/blog/multiple-asserts-are-ok/">Multiple Asserts Are OK</a></li>
  <li><a href="https://mfranc.com/unit-testing/good-unit-test-one-assert/">Good Unit Test - One Assert</a></li>
</ul>

<h2 id="tocAnchor-1-4-4">TL;DR</h2>

<p>Este es el resumen de buenas prácticas a la hora de definir tus tests:</p>

<ul>
  <li>armá los escenarios que definen las clases de equivalencia de los tests</li>
  <li>escribí la descripción de los describes y los tests explicando <strong>qué</strong> estamos testeando. El cómo lo terminás de ver en el código, <strong>evitá duplicidades</strong> entre el texto que explica y el código escrito</li>
  <li>separá los describes por requerimientos / casos de uso y los tests por escenarios donde quede claro la clase de equivalencia (cliente común, flota, etc.)</li>
  <li>los nombres de las variables deben reflejar la clase de equivalencia que están resolviendo, y no casos particulares que no revelan la intención de lo que estamos modelando (sí <code class="language-plaintext highlighter-rouge">flotaConPocosAutos</code>, no <code class="language-plaintext highlighter-rouge">flotinha</code> o <code class="language-plaintext highlighter-rouge">miFlota</code>)</li>
  <li>los tests se suelen estructurar utilizando las tres A: Arrange (el setup que conviene mantenerlo simple), Act (operaciones con efecto cuando corresponde) y Assert (las aserciones que deben testear el mismo concepto en cada test)</li>
</ul>

<h2 id="tocAnchor-1-4-5">Links relacionados</h2>

<ul>
  <li><a href="https://youtu.be/7rw3SNVI5yY">Video en youtube que explica cobertura y clases de equivalencia en un proyecto Kotlin</a></li>
  <li>Si conocés Ruby, te recomendamos <a href="http://www.betterspecs.org/">Better specs</a></li>
  <li><a href="algo2-temario.html">Página principal de Algoritmos 2</a></li>
</ul>

</div>





<div id="article_metadata">
    <!-- <p><i>Latest update on March 07, 2024 by
        Fernando Dodino</i></p>

    <ul class="accordion" data-accordion>
        <li class="accordion-navigation">
            <a href="#panel1a">Page History, Meta information</a>

            <div id="panel1a" class="content">

                <div class="rows">
                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Page Commits</th>
                                <th>Page Additions</th>
                                <th>Page Deletions</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr>
                                <td>5</td>
                                <td>286</td>
                                <td>17</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Commits</th>
                            <tr>
                            </thead>

                            <tbody>
                            
                            <tr>
                                <td>Fernando Dodino</td>
                                <td>fernand...</td>
                                <td>5</td>
                            </tr>
                            
                            </tbody>
                        </table>
                    </div>
                </div>

                <table style="margin-left: 15px;">
                    <thead>
                    <tr>
                        <th>Hash</th>
                        <th>Time</th>
                        <th>Name</th>
                        <th>Mail</th>
                        <th>Subject</th>
                    <tr>
                    </thead>

                    <tbody>
                    
                    <tr>
                        <td>09dd0fc2</td>
                        <td>Thu Mar 7 07:47:36 2024 -0300</td>
                        <td>Fernando Dodino</td>
                        <td>fernand...</td>
                        <td>Enhance docs</td>
                    </tr>
                    
                    <tr>
                        <td>05b72114</td>
                        <td>Sun Mar 20 12:12:11 2022 -0300</td>
                        <td>Fernando Dodino</td>
                        <td>fernand...</td>
                        <td>Adding links to youtube videos</td>
                    </tr>
                    
                    <tr>
                        <td>95c0a115</td>
                        <td>Wed Mar 9 23:30:58 2022 -0300</td>
                        <td>Fernando Dodino</td>
                        <td>fernand...</td>
                        <td>Better link to equivalence partitioning</td>
                    </tr>
                    
                    <tr>
                        <td>f9633f2e</td>
                        <td>Wed Mar 9 22:14:44 2022 -0300</td>
                        <td>Fernando Dodino</td>
                        <td>fernand...</td>
                        <td>Fix typos and writing</td>
                    </tr>
                    
                    <tr>
                        <td>760f783b</td>
                        <td>Sat Jan 29 18:28:57 2022 -0300</td>
                        <td>Fernando Dodino</td>
                        <td>fernand...</td>
                        <td>Testing in Kotest</td>
                    </tr>
                    
                    </tbody>
                </table>

            </div>
        </li>
    </ul> -->

</div>


</div>


<div id="footer">
    <div class="columns small-12 medium-12 large-12">
        © 2025 - Uqbar Foundation
    </div>
</div>

<script>
    'use strict';
</script>

<script src="/assets/jquery-aa71a7b50270602be524223735204e4e.js"></script>
<script src="/assets/jquery.min-92bca385e77eff06fdfc99d71ff5d9cb.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="/assets/foundation/foundation-9cdbe0bbce183118de08f9938e53d976.js"></script>
<script src="/assets/foundation/foundation.abide-89a2bdc8d7b0219f70b26edf2ae6887e.js"></script>
<script src="/assets/foundation/foundation.accordion-fb975cac4e1d51205357ccef64ad87f4.js"></script>
<script src="/assets/foundation/foundation.alert-09f0ede105a8181ae99c1e952f89ca3b.js"></script>
<script src="/assets/foundation/foundation.clearing-1720b58085d63e88f45a453bb9ad3e3b.js"></script>
<script src="/assets/foundation/foundation.dropdown-644acf98749f084fdf912c4b00957f31.js"></script>
<script src="/assets/foundation/foundation.equalizer-97288e933d9acc43fab592768c628ba6.js"></script>
<script src="/assets/foundation/foundation.interchange-083c4df6919a083e985b5e687d5c30b9.js"></script>
<script src="/assets/foundation/foundation.joyride-c8c49db46553294043e6ec5c19e1285b.js"></script>
<script src="/assets/foundation/foundation.magellan-2fb6e4d1e4284a920b3a7d892e2cb54c.js"></script>
<script src="/assets/foundation/foundation.offcanvas-63af9a0eca0822c6f6a77ba0eb3dd7ec.js"></script>
<script src="/assets/foundation/foundation.orbit-79b5540e0f58a265fd959aaf18fc2345.js"></script>
<script src="/assets/foundation/foundation.reveal-620cbbd491fb6eaf8dc057949a254e29.js"></script>
<script src="/assets/foundation/foundation.slider-e5da59a7bd13309d315a6a95e0654b35.js"></script>
<script src="/assets/foundation/foundation.tab-9ea3a242acf982f76f891ac5e32aa92a.js"></script>
<script src="/assets/foundation/foundation.tooltip-926551742e978e4456aa7ca8c6ffe334.js"></script>
<script src="/assets/foundation/foundation.topbar-fa936a3a88514cb2c51c4ccf3fefaeb0.js"></script>

<script src="/assets/jquery.cookie-600df63e64417ec0c172cd3580ffe4f3.js"></script>
<!-- Script pointing to jekyll-search.js -->
<script src="/assets/jekyll-search-db248d3bf113e122870c09fd6d9b0592.js"></script>

<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: "/search.json"
    });

    $(document).foundation();

</script>

<!-- prism.js -->
<script src="/assets/prism-193ebecb65a347c425ecdb3c4592fd0e.js"></script>
</body>
</html>
